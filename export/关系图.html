<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ—æµ·æ¡ˆä»¶å…³ç³»å›¾</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #fff;
        }
        #root {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        #flow-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        /* èŠ‚ç‚¹æ ·å¼ */
        .defendant {
            background: #dc2626; /* çº¢è‰²ï¼šè¢«å‘Šäºº */
            color: white;
            border: 3px solid #991b1b;
            padding: 15px;
            border-radius: 12px;
            font-weight: 900;
            width: 220px;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .intermediary {
            background: #059669; /* ç»¿è‰²ï¼šä¸­é—´äºº */
            color: white;
            border: 2px solid #047857;
            padding: 10px;
            border-radius: 8px;
            width: 180px;
            text-align: center;
            font-weight: bold;
        }
        .briber {
            background: #3b82f6; /* è“è‰²ï¼šè¡Œè´¿äºº/æœªé‚ */
            color: white;
            border: 1px solid #1d4ed8;
            padding: 8px;
            border-radius: 6px;
            width: 160px;
            font-size: 12px;
            text-align: center;
        }
        .money-held-by-wang {
            background: #ef4444; /* çº¢åº•ï¼šè¢«å‘Šäººæ§åˆ¶ */
            color: white;
            border: 2px dashed white;
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
            width: 180px;
            text-align: left;
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.4);
        }
        .money-held-by-intermediary {
            background: #10b981; /* ç»¿åº•ï¼šä¸­é—´äººæ§åˆ¶ */
            color: white;
            border: 1px solid #059669;
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
            width: 180px;
            text-align: left;
        }
        .money-held-by-briber {
            background: #93c5fd; /* æµ…è“åº•ï¼šè¡Œè´¿äººä¿ç®¡/æœªé‚ */
            color: #1e3a8a; 
            border: 1px dashed #3b82f6;
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
            width: 180px;
            text-align: left;
            font-style: italic;
        }
        .annotation {
            font-size: 14px;
            font-weight: bold;
            background: #fff;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            color: #333;
        }
        .node-container {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .sub-label {
            font-size: 11px;
            opacity: 0.9;
            margin-top: 4px;
        }
        .amount {
            font-size: 11px;
            margin-top: 4px;
            padding-top: 2px;
            border-top: 1px solid rgba(255,255,255,0.3);
        }
        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        .analysis-panel {
            padding: 20px;
            font-family: sans-serif;
            border-top: 2px solid #eee;
            background-color: #f8fafc;
        }
        .analysis-title {
            margin-top: 0;
            color: #334155;
            border-bottom: 2px solid #cbd5e1;
            padding-bottom: 10px;
        }
        .analysis-content {
            display: flex;
            flex-direction: row;
            gap: 30px;
            flex-wrap: wrap;
        }
        .chart-container {
            flex: 0 0 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .pie-chart {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(#dc2626 0% 5.3%, #10b981 5.3% 63.7%, #3b82f6 63.7% 100%);
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .legend {
            width: 100%;
            font-size: 12px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            margin-right: 8px;
            border-radius: 2px;
        }
        .text-analysis {
            flex: 1;
            min-width: 300px;
        }
        .analysis-section {
            margin-bottom: 15px;
        }
        .section-title {
            margin: 0 0 5px 0;
            display: flex;
            align-items: center;
        }
        .section-content {
            font-size: 13px;
            line-height: 1.6;
            color: #334155;
            margin: 0;
        }
    </style>
</head>
<body>
    <div id="root">
        <div id="flow-container">
            <svg></svg>
        </div>
        <div class="analysis-panel">
            <h3 class="analysis-title">ğŸ“Š èµ„é‡‘å®é™…æµå‘ä¸æ§åˆ¶æƒåˆ†æ (æ€»æŒ‡æ§é‡‘é¢ï¼š7539ä¸‡å…ƒ)</h3>
            <div class="analysis-content">
                <div class="chart-container">
                    <div class="pie-chart"></div>
                    <div class="legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background: #dc2626;"></span>
                            <span>è¢«å‘Šäººå®é™…å æœ‰: <b>5.3%</b> (400ä¸‡)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: #10b981;"></span>
                            <span>ä¸­é—´äººæˆªç•™: <b>58.4%</b> (4402ä¸‡)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: #3b82f6;"></span>
                            <span>ç©ºå¤´æ”¯ç¥¨/æœªé‚: <b>36.3%</b> (2737ä¸‡)</span>
                        </div>
                    </div>
                </div>
                <div class="text-analysis">
                    <div class="analysis-section">
                        <h4 class="section-title" style="color: #b91c1c;">ğŸ”´ "å®é™…å—è´¿"ï¼ˆå…¥è¢‹ï¼‰</h4>
                        <p class="section-content">
                            è¯·æ³¨æ„å›¾è¡¨å·¦ä¸Šè§’çš„çº¢è‰²å®çº¿åŒºåŸŸã€‚åªæœ‰äº‹å®ä¹ï¼ˆæ—æ±‰æ«250ä¸‡ï¼‰å’Œäº‹å®å…­ï¼ˆç‹æ…§150ä¸‡ï¼‰è¿™ä¸¤ç¬”ï¼Œå…±è®¡<b>400ä¸‡å…ƒ</b>ï¼Œç¡®å‡¿æ— ç–‘åœ°è¿›å…¥äº†ç‹é›„æ˜Œä¸ªäººçš„æ§åˆ¶èŒƒå›´ï¼ˆå¦‚ç‚’è‚¡ã€ç°é‡‘æ”¶å—ï¼‰ã€‚<br/>
                            ç›¸æ¯”ä¹‹ä¸‹ï¼Œèµ·è¯‰ä¹¦æŒ‡æ§çš„æ€»é¢æ˜¯7539ä¸‡ã€‚è¿™æ„å‘³ç€ï¼Œ<b>è¶…è¿‡94%çš„æŒ‡æ§é‡‘é¢ï¼Œç‹é›„æ˜Œå¹¶æœªå‘ç”Ÿç‰©ç†ä¸Šçš„æ¥è§¦æˆ–å æœ‰ã€‚</b>
                        </p>
                    </div>
                    <div class="analysis-section">
                        <h4 class="section-title" style="color: #047857;">ğŸŸ¢ "ä¸­é—´äººæˆªç•™"ï¼ˆåº•éƒ¨ç»¿è‰²åŒºåŸŸï¼‰</h4>
                        <p class="section-content">
                            åœ¨æ¶‰åŠå»–ç‚¼ç‚¼ã€è‹æ—ã€å´å«æ˜ã€ä½•æ–Œçš„å‡ èµ·å…±åŒå—è´¿ä¸­ï¼Œèµ„é‡‘å‡ ä¹å…¨éƒ¨åœç•™åœ¨ä¸­é—´äººæ‰‹ä¸­ã€‚
                            ç‰¹åˆ«æ˜¯äº‹å®ä¸€å’Œäº‹å®äºŒï¼Œä¸­é—´äººæˆªç•™äº†80%ä»¥ä¸Šçš„åˆ©ç›Šï¼Œè€Œç‹é›„æ˜Œæ‰€è°“çš„"ä»½å­é’±"ä¹Ÿæ˜¯ç”±å»–ç‚¼ç‚¼"ä»£ä¸ºä¿ç®¡"ã€‚è¿™ç§<b>"é’±åœ¨åˆ«äººæ‰‹ï¼Œç½ªåœ¨æˆ‘å¤´ä¸Š"</b>çš„ç»“æ„ï¼Œé€€ä¸€ä¸‡æ­¥è®²ï¼Œè‡³å°‘ä¹Ÿåº”è®¤å®š<b>ä»çŠ¯</b>ã€‚
                        </p>
                    </div>
                    <div class="analysis-section">
                        <h4 class="section-title" style="color: #1d4ed8;">ğŸ”µ "ç©ºå¤´æ”¯ç¥¨"ï¼ˆå³ä¾§è“è‰²åŒºåŸŸï¼‰</h4>
                        <p class="section-content">
                            äº‹å®ä¸ƒï¼ˆç‹æ™“æ¯…ï¼‰å’Œäº‹å®å…«ï¼ˆè’‹å…†å›½ï¼‰å…±è®¡1000ä¸‡å…ƒï¼Œæ ‡è®°ä¸º"è¡Œè´¿äººä¿ç®¡"ã€‚è¿™åœ¨å›¾ä¸Šæ˜¾ç¤ºä¸ºèµ„é‡‘æµåŠ¨çš„æ­»å¾ªç¯â€”â€”é’±æ ¹æœ¬æ²¡æœ‰ç¦»å¼€è¡Œè´¿äººçš„å£è¢‹ã€‚è¿™éƒ¨åˆ†é‡‘é¢åº”è®¤å®š<b>æ— ç½ª</b>ã€é€€ä¸€ä¸‡æ­¥è®²ä¹Ÿæ˜¯å®š<b>"ä¸èƒ½çŠ¯æœªé‚"</b>ï¼ˆè¡Œè´¿äººæ ¹æœ¬æ²¡æœ‰æ”¯ä»˜èƒ½åŠ›å’Œæ”¯ä»˜æ„æ„¿ï¼‰ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // èŠ‚ç‚¹æ•°æ®
        const nodes = [
            // 1. ä¸­å¿ƒè¢«å‘Šäºº
            {
                id: 'wang',
                type: 'defendant',
                label: 'è¢«å‘Šäººï¼šç‹é›„æ˜Œ',
                subLabel: 'å®é™…ç»æ‰‹æå°‘ï¼Œå¤šä¸º"çŸ¥æƒ…"',
                x: 600,
                y: 350
            },

            // --- å·¦ä¸Šè§’ï¼šå®é™…ç»æ‰‹ (çº¢è‰²) ---
            {
                id: 'note-direct',
                type: 'annotation',
                label: 'ä¸€ã€å®é™…å æœ‰ (çº¢è‰²åŒºåŸŸ)',
                x: 100,
                y: 50
            },
            {
                id: 'fact9',
                type: 'briber',
                label: 'äº‹å®ä¹ï¼šæ—æ±‰æ«',
                subLabel: 'ç›´æ¥é€ç°é‡‘/è½¬è´¦',
                x: 50,
                y: 120
            },
            {
                id: 'money9',
                type: 'money-held-by-wang',
                label: 'âš ï¸ å®é™…å…¥è¢‹',
                amount: '250ä¸‡å…ƒ (ç‚’è‚¡è·åˆ©)',
                subLabel: 'ç‹é›„æ˜Œäº²è‡ªæ§åˆ¶',
                x: 50,
                y: 220
            },
            {
                id: 'fact6',
                type: 'briber',
                label: 'äº‹å®å…­ï¼šç‹æ…§',
                subLabel: 'æ—©æœŸå®æ³¢ä»»èŒæœŸé—´',
                x: 250,
                y: 120
            },
            {
                id: 'money6-real',
                type: 'money-held-by-wang',
                label: 'âš ï¸ å®é™…å…¥è¢‹',
                amount: '150ä¸‡å…ƒ',
                subLabel: 'ç‹é›„æ˜Œäº²è‡ªæ”¶å—',
                x: 250,
                y: 220
            },
            {
                id: 'money6-fake',
                type: 'money-held-by-briber',
                label: 'âŒ æœªé‚/æœªä»˜',
                amount: '525ä¸‡å…ƒ',
                subLabel: 'å°šæœªå®é™…å–å¾—',
                x: 250,
                y: 300
            },

            // --- å³ä¾§ï¼šæ‰¿è¯ºå‹/è¡Œè´¿äººä¿ç®¡ (è“è‰²) ---
            {
                id: 'note-promise',
                type: 'annotation',
                label: 'äºŒã€ç©ºå¤´æ”¯ç¥¨/æœªé‚ (è“è‰²åŒºåŸŸ)',
                x: 900,
                y: 50
            },
            {
                id: 'fact7',
                type: 'briber',
                label: 'äº‹å®ä¸ƒï¼šç‹æ™“æ¯…',
                subLabel: 'å£å¤´æ‰¿è¯º',
                x: 900,
                y: 120
            },
            {
                id: 'money7',
                type: 'money-held-by-briber',
                label: 'ğŸ”’ è¡Œè´¿äººä¿ç®¡',
                amount: '600ä¸‡å…ƒ',
                subLabel: 'é’±ä»åœ¨è¡Œè´¿äººå¤„',
                x: 900,
                y: 220
            },
            {
                id: 'fact8',
                type: 'briber',
                label: 'äº‹å®å…«ï¼šè’‹å…†å›½',
                subLabel: 'å£å¤´æ‰¿è¯º',
                x: 1100,
                y: 120
            },
            {
                id: 'money8',
                type: 'money-held-by-briber',
                label: 'ğŸ”’ è¡Œè´¿äººä¿ç®¡',
                amount: '400ä¸‡å…ƒ',
                subLabel: 'é’±ä»åœ¨è¡Œè´¿äººå¤„',
                x: 1100,
                y: 220
            },

            // --- åº•éƒ¨ï¼šä¸­é—´äººæ§åˆ¶ (ç»¿è‰²) ---
            {
                id: 'note-group',
                type: 'annotation',
                label: 'ä¸‰ã€ä¸­é—´äººæˆªç•™ (ç»¿è‰²åŒºåŸŸ)',
                x: 500,
                y: 500
            },
            
            // äº‹å®ä¸€ & äºŒ (å»–ç‚¼ç‚¼å›¢ä¼™)
            {
                id: 'group1',
                type: 'intermediary',
                label: 'ä¸­é—´äººå›¢ä¼™',
                subLabel: 'å»–ç‚¼ç‚¼ã€è‹æ—ã€é»å°å®‹',
                x: 100,
                y: 600
            },
            {
                id: 'money1',
                type: 'money-held-by-intermediary',
                label: 'ğŸ”’ å»–ç‚¼ç‚¼ä¿ç®¡ (äº‹å®ä¸€)',
                amount: '340ä¸‡å…ƒ (å 20%)',
                subLabel: 'ç‹é›„æ˜Œä»æœªç»æ‰‹',
                x: 50,
                y: 700
            },
            {
                id: 'money1-rem',
                type: 'money-held-by-intermediary',
                label: 'ğŸ’¸ å›¢ä¼™æˆªç•™ (äº‹å®ä¸€)',
                amount: '1360ä¸‡+ (å 80%)',
                subLabel: 'è‹/é»å®é™…å æœ‰',
                x: 50,
                y: 780
            },
            {
                id: 'money2',
                type: 'money-held-by-intermediary',
                label: 'ğŸ”’ å»–ç‚¼ç‚¼ä¿ç®¡ (äº‹å®äºŒ)',
                amount: '180ä¸‡å…ƒ (å 20%)',
                subLabel: 'ç‹é›„æ˜Œä»æœªç»æ‰‹',
                x: 250,
                y: 700
            },
            {
                id: 'money2-rem',
                type: 'money-held-by-intermediary',
                label: 'ğŸ’¸ å›¢ä¼™æˆªç•™ (äº‹å®äºŒ)',
                amount: '1000ä¸‡+ (å 80%)',
                subLabel: 'è‹/é»å®é™…å æœ‰',
                x: 250,
                y: 780
            },

            // äº‹å®ä¸‰ (è°¢æ–Œ/æ³°å˜‰)
            {
                id: 'intermediary-xie',
                type: 'intermediary',
                label: 'ä¸­é—´äººï¼šè°¢æ–Œ',
                subLabel: 'æ³°å˜‰é¡¹ç›®å¼•è¿›äºº',
                x: 500,
                y: 600
            },
            {
                id: 'money3-xie',
                type: 'money-held-by-intermediary',
                label: 'ğŸ’¸ è°¢æ–Œå æœ‰',
                amount: '400ä¸‡å…ƒ',
                subLabel: 'ç‹é›„æ˜Œä»…"çŸ¥æƒ…"',
                x: 500,
                y: 700
            },
            {
                id: 'money3-fake',
                type: 'money-held-by-briber',
                label: 'âŒ æœªé‚ (ç”»é¥¼)',
                amount: '1000ä¸‡å…ƒ',
                subLabel: 'è®¸äºè¾°æ— æ”¯ä»˜èƒ½åŠ›',
                x: 500,
                y: 780
            },

            // äº‹å®å›› (å´å«æ˜)
            {
                id: 'intermediary-wu',
                type: 'intermediary',
                label: 'ä¸­é—´äººï¼šå´å«æ˜',
                subLabel: 'ç§è¥ä¼ä¸šä¸»',
                x: 700,
                y: 600
            },
            {
                id: 'money4',
                type: 'money-held-by-intermediary',
                label: 'ğŸ’¸ å´å«æ˜å æœ‰',
                amount: 'çº¦982ä¸‡å…ƒ',
                subLabel: 'ç‹é›„æ˜Œä»…"çŸ¥æƒ…/åŒæ„"',
                x: 700,
                y: 700
            },

            // äº‹å®äº” (ä½•æ–Œ)
            {
                id: 'intermediary-he',
                type: 'intermediary',
                label: 'ä¸­é—´äººï¼šä½•æ–Œ',
                subLabel: 'åŸå›½ä¼è€æ€»',
                x: 900,
                y: 600
            },
            {
                id: 'money5',
                type: 'money-held-by-intermediary',
                label: 'ğŸ’¸ ä½•æ–Œå æœ‰',
                amount: '400ä¸‡å…ƒ',
                subLabel: 'ç‹é›„æ˜Œä»…"çŸ¥æƒ…"',
                x: 900,
                y: 700
            },
            {
                id: 'money5-fake',
                type: 'money-held-by-briber',
                label: 'âŒ æœªé‚',
                amount: '200ä¸‡å…ƒ',
                subLabel: 'æœªå®é™…å–å¾—',
                x: 900,
                y: 780
            }
        ];

        // è¿æ¥çº¿æ•°æ®
        const edges = [
            { id: 'e-w-m9', source: 'fact9', target: 'money9', animated: true },
            { id: 'e-m9-w', source: 'money9', target: 'wang', style: { stroke: '#ef4444', strokeWidth: 3 }, label: 'å®é™…æµå…¥' },
            { id: 'e-w-m6', source: 'fact6', target: 'money6-real', animated: true },
            { id: 'e-m6-w', source: 'money6-real', target: 'wang', style: { stroke: '#ef4444', strokeWidth: 3 }, label: 'å®é™…æµå…¥' },
            { id: 'e-fact6-fake', source: 'fact6', target: 'money6-fake' },
            { id: 'e-f7-m7', source: 'fact7', target: 'money7', animated: true },
            { id: 'e-m7-w', source: 'money7', target: 'wang', style: { stroke: '#94a3b8', strokeDasharray: '5 5' }, label: 'æœªç‰©ç†è½¬ç§»' },
            { id: 'e-f8-m8', source: 'fact8', target: 'money8', animated: true },
            { id: 'e-m8-w', source: 'money8', target: 'wang', style: { stroke: '#94a3b8', strokeDasharray: '5 5' }, label: 'æœªç‰©ç†è½¬ç§»' },
            { id: 'e-g1-m1', source: 'group1', target: 'money1', label: 'ä¿ç®¡' },
            { id: 'e-g1-m1rem', source: 'group1', target: 'money1-rem', label: 'æˆªç•™' },
            { id: 'e-g1-m2', source: 'group1', target: 'money2', label: 'ä¿ç®¡' },
            { id: 'e-g1-m2rem', source: 'group1', target: 'money2-rem', label: 'æˆªç•™' },
            { id: 'e-w-g1', source: 'wang', target: 'group1', style: { stroke: '#10b981', strokeDasharray: '5 5' }, label: 'é€šè¿‡ä¸­é—´äºº' },
            { id: 'e-xie-m3', source: 'intermediary-xie', target: 'money3-xie', label: 'å æœ‰' },
            { id: 'e-w-xie', source: 'wang', target: 'intermediary-xie', style: { stroke: '#10b981', strokeDasharray: '5 5' }, label: 'çŸ¥æƒ…' },
            { id: 'e-wu-m4', source: 'intermediary-wu', target: 'money4', label: 'å æœ‰' },
            { id: 'e-w-wu', source: 'wang', target: 'intermediary-wu', style: { stroke: '#10b981', strokeDasharray: '5 5' }, label: 'çŸ¥æƒ…' },
            { id: 'e-he-m5', source: 'intermediary-he', target: 'money5', label: 'å æœ‰' },
            { id: 'e-w-he', source: 'wang', target: 'intermediary-he', style: { stroke: '#10b981', strokeDasharray: '5 5' }, label: 'çŸ¥æƒ…' }
        ];

        // æ¸²æŸ“å‡½æ•°
        function render() {
            const container = document.getElementById('flow-container');
            const svg = container.querySelector('svg');
            
            // æ¸…ç©º SVG
            while (svg.firstChild) {
                svg.removeChild(svg.firstChild);
            }
            
            // æ¸²æŸ“èŠ‚ç‚¹
            nodes.forEach(node => {
                const nodeEl = document.createElement('div');
                nodeEl.className = `node-container ${node.type.replace(/-/g, '')}`;
                nodeEl.style.left = `${node.x}px`;
                nodeEl.style.top = `${node.y}px`;
                nodeEl.dataset.id = node.id;
                
                const labelEl = document.createElement('div');
                labelEl.textContent = node.label;
                nodeEl.appendChild(labelEl);
                
                if (node.subLabel) {
                    const subLabelEl = document.createElement('div');
                    subLabelEl.className = 'sub-label';
                    subLabelEl.textContent = node.subLabel;
                    nodeEl.appendChild(subLabelEl);
                }
                
                if (node.amount) {
                    const amountEl = document.createElement('div');
                    amountEl.className = 'amount';
                    amountEl.innerHTML = 'ğŸ’° ' + node.amount;
                    nodeEl.appendChild(amountEl);
                }
                
                container.appendChild(nodeEl);
            });
            
            // æ¸²æŸ“è¿æ¥çº¿
            edges.forEach(edge => {
                const sourceNode = nodes.find(n => n.id === edge.source);
                const targetNode = nodes.find(n => n.id === edge.target);
                
                if (sourceNode && targetNode) {
                    // è®¡ç®—èŠ‚ç‚¹ä¸­å¿ƒç‚¹
                    let sourceWidth, sourceHeight, targetWidth, targetHeight;
                    
                    switch(sourceNode.type) {
                        case 'defendant':
                            sourceWidth = 110;
                            sourceHeight = 30;
                            break;
                        case 'intermediary':
                            sourceWidth = 90;
                            sourceHeight = 25;
                            break;
                        case 'briber':
                            sourceWidth = 80;
                            sourceHeight = 25;
                            break;
                        case 'money-held-by-wang':
                        case 'money-held-by-intermediary':
                        case 'money-held-by-briber':
                            sourceWidth = 90;
                            sourceHeight = 20;
                            break;
                        default:
                            sourceWidth = 70;
                            sourceHeight = 15;
                    }
                    
                    switch(targetNode.type) {
                        case 'defendant':
                            targetWidth = 110;
                            targetHeight = 30;
                            break;
                        case 'intermediary':
                            targetWidth = 90;
                            targetHeight = 25;
                            break;
                        case 'briber':
                            targetWidth = 80;
                            targetHeight = 25;
                            break;
                        case 'money-held-by-wang':
                        case 'money-held-by-intermediary':
                        case 'money-held-by-briber':
                            targetWidth = 90;
                            targetHeight = 20;
                            break;
                        default:
                            targetWidth = 70;
                            targetHeight = 15;
                    }
                    
                    const sourceX = sourceNode.x + sourceWidth;
                    const sourceY = sourceNode.y + sourceHeight;
                    const targetX = targetNode.x + targetWidth;
                    const targetY = targetNode.y + targetHeight;
                    
                    // åˆ›å»ºçº¿æ¡
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', sourceX);
                    line.setAttribute('y1', sourceY);
                    line.setAttribute('x2', targetX);
                    line.setAttribute('y2', targetY);
                    line.setAttribute('stroke', edge.style ? edge.style.stroke : '#666');
                    line.setAttribute('stroke-width', edge.style ? edge.style.strokeWidth || 2 : 2);
                    
                    if (edge.style && edge.style.strokeDasharray) {
                        line.setAttribute('stroke-dasharray', edge.style.strokeDasharray);
                    }
                    
                    if (edge.animated) {
                        line.classList.add('animated');
                        // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                        const animate = document.createElementNS('http://www.w3.org/2000/svg', 'animate');
                        animate.setAttribute('attributeName', 'stroke-dashoffset');
                        animate.setAttribute('values', '0;-20');
                        animate.setAttribute('dur', '1s');
                        animate.setAttribute('repeatCount', 'indefinite');
                        line.appendChild(animate);
                    }
                    
                    svg.appendChild(line);
                    
                    // æ·»åŠ ç®­å¤´
                    const arrow = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                    const angle = Math.atan2(targetY - sourceY, targetX - sourceX);
                    const arrowSize = 6;
                    const points = [
                        `${targetX},${targetY}`,
                        `${targetX - arrowSize * Math.cos(angle - Math.PI/6)},${targetY - arrowSize * Math.sin(angle - Math.PI/6)}`,
                        `${targetX - arrowSize * Math.cos(angle + Math.PI/6)},${targetY - arrowSize * Math.sin(angle + Math.PI/6)}`
                    ].join(' ');
                    arrow.setAttribute('points', points);
                    arrow.setAttribute('fill', edge.style ? edge.style.stroke : '#666');
                    svg.appendChild(arrow);
                    
                    // æ·»åŠ æ ‡ç­¾
                    if (edge.label) {
                        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                        text.setAttribute('x', (sourceX + targetX) / 2);
                        text.setAttribute('y', (sourceY + targetY) / 2 - 5);
                        text.setAttribute('text-anchor', 'middle');
                        text.setAttribute('font-size', '12');
                        text.setAttribute('fill', '#333');
                        text.textContent = edge.label;
                        svg.appendChild(text);
                    }
                }
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ¸²æŸ“
        document.addEventListener('DOMContentLoaded', render);
    </script>
</body>
</html>